{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rickygould/Downloads/web102_unit7lab-main/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rickygould/Downloads/web102_unit7lab-main/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rickygould/Downloads/web102_unit7lab-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import{supabase}from'../client';import'./PostPage.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PostPage=function PostPage(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),commenterName=_useState4[0],setCommenterName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),commentContent=_useState6[0],setCommentContent=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),comments=_useState8[0],setComments=_useState8[1];useEffect(function(){var fetchPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$supabase$from$,data,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return supabase.from('Posts').select('*').eq('id',id).single();case 3:_yield$supabase$from$=_context.sent;data=_yield$supabase$from$.data;error=_yield$supabase$from$.error;if(!error){_context.next=8;break;}throw error;case 8:setPost(data);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.error('Error fetching post:',_context.t0.message);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function fetchPost(){return _ref.apply(this,arguments);};}();var fetchComments=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$supabase$from$2,data,error;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return supabase.from('Comments').select('*').eq('post_id',id);case 3:_yield$supabase$from$2=_context2.sent;data=_yield$supabase$from$2.data;error=_yield$supabase$from$2.error;if(!error){_context2.next=8;break;}throw error;case 8:setComments(data);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);console.error('Error fetching comments:',_context2.t0.message);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function fetchComments(){return _ref2.apply(this,arguments);};}();fetchPost();fetchComments();},[id]);var handleSubmitComment=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(event){var _yield$supabase$from$3,data,error;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();_context3.prev=1;_context3.next=4;return supabase.from('Comments').insert([{post_id:id,commenter_name:commenterName,text:commentContent}]);case 4:_yield$supabase$from$3=_context3.sent;data=_yield$supabase$from$3.data;error=_yield$supabase$from$3.error;if(!error){_context3.next=9;break;}throw error;case 9:// Reload the page to reset the text boxes and display the new comment\nwindow.location.reload();_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](1);console.error('Error adding comment:',_context3.t0.message);case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[1,12]]);}));return function handleSubmitComment(_x){return _ref3.apply(this,arguments);};}();var handleDeleteComment=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(commentId){var updatedComments;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return supabase.from('Comments').delete().eq('id',commentId);case 3:// Filter out the deleted comment from the comments array\nupdatedComments=comments.filter(function(comment){return comment.id!==commentId;});setComments(updatedComments);_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);console.error('Error deleting comment:',_context4.t0.message);case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function handleDeleteComment(_x2){return _ref4.apply(this,arguments);};}();if(!post){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"PostPage\",children:[/*#__PURE__*/_jsx(\"h2\",{children:post.title}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Author: \",post.author]}),post.image&&/*#__PURE__*/_jsx(\"img\",{src:post.image,alt:\"Post\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Description: \",post.description]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Created at: \",new Date(post.created_at).toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Comments\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitComment,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Your Name\",value:commenterName,onChange:function onChange(event){return setCommenterName(event.target.value);},required:true}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Your Comment\",value:commentContent,onChange:function onChange(event){return setCommentContent(event.target.value);},required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit Comment\"})]}),/*#__PURE__*/_jsx(\"div\",{children:comments.map(function(comment){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:comment.commenter_name}),/*#__PURE__*/_jsx(\"p\",{children:comment.text}),/*#__PURE__*/_jsx(\"p\",{children:new Date(comment.created_at).toLocaleString()}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleDeleteComment(comment.id);},children:\"Delete\"})]},comment.id);})})]})]});};export default PostPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","supabase","PostPage","id","post","setPost","commenterName","setCommenterName","commentContent","setCommentContent","comments","setComments","fetchPost","from","select","eq","single","data","error","console","message","fetchComments","handleSubmitComment","event","preventDefault","insert","post_id","commenter_name","text","window","location","reload","handleDeleteComment","commentId","delete","updatedComments","filter","comment","title","author","image","description","Date","created_at","toLocaleString","target","value","map"],"sources":["/Users/rickygould/Downloads/web102_unit7lab-main/client/src/pages/PostPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { supabase } from '../client';\nimport './PostPage.css';\n\nconst PostPage = () => {\n  const { id } = useParams();\n  const [post, setPost] = useState(null);\n  const [commenterName, setCommenterName] = useState('');\n  const [commentContent, setCommentContent] = useState('');\n  const [comments, setComments] = useState([]);\n\n  useEffect(() => {\n    const fetchPost = async () => {\n      try {\n        const { data, error } = await supabase\n          .from('Posts')\n          .select('*')\n          .eq('id', id)\n          .single();\n        if (error) {\n          throw error;\n        }\n        setPost(data);\n      } catch (error) {\n        console.error('Error fetching post:', error.message);\n      }\n    };\n\n    const fetchComments = async () => {\n      try {\n        const { data, error } = await supabase\n          .from('Comments')\n          .select('*')\n          .eq('post_id', id);\n        if (error) {\n          throw error;\n        }\n        setComments(data);\n      } catch (error) {\n        console.error('Error fetching comments:', error.message);\n      }\n    };\n\n    fetchPost();\n    fetchComments();\n  }, [id]);\n\n  const handleSubmitComment = async (event) => {\n    event.preventDefault();\n    try {\n      const { data, error } = await supabase.from('Comments').insert([\n        {\n          post_id: id,\n          commenter_name: commenterName,\n          text: commentContent,\n        },\n      ]);\n      if (error) {\n        throw error;\n      }\n      // Reload the page to reset the text boxes and display the new comment\n      window.location.reload();\n    } catch (error) {\n      console.error('Error adding comment:', error.message);\n    }\n  };\n\n  const handleDeleteComment = async (commentId) => {\n    try {\n      await supabase.from('Comments').delete().eq('id', commentId);\n      // Filter out the deleted comment from the comments array\n      const updatedComments = comments.filter((comment) => comment.id !== commentId);\n      setComments(updatedComments);\n    } catch (error) {\n      console.error('Error deleting comment:', error.message);\n    }\n  };\n\n  if (!post) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"PostPage\">\n      <h2>{post.title}</h2>\n      <p>Author: {post.author}</p>\n      {post.image && <img src={post.image} alt=\"Post\" />}\n      <p>Description: {post.description}</p>\n      <p>Created at: {new Date(post.created_at).toLocaleString()}</p>\n\n      <div>\n        <h3>Comments</h3>\n        <form onSubmit={handleSubmitComment}>\n          <input\n            type=\"text\"\n            placeholder=\"Your Name\"\n            value={commenterName}\n            onChange={(event) => setCommenterName(event.target.value)}\n            required\n          />\n          <textarea\n            placeholder=\"Your Comment\"\n            value={commentContent}\n            onChange={(event) => setCommentContent(event.target.value)}\n            required\n          />\n          <button type=\"submit\">Submit Comment</button>\n        </form>\n        <div>\n          {comments.map((comment) => (\n            <div key={comment.id}>\n              <p>{comment.commenter_name}</p>\n              <p>{comment.text}</p>\n              <p>{new Date(comment.created_at).toLocaleString()}</p>\n              <button onClick={() => handleDeleteComment(comment.id)}>Delete</button>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PostPage;\n"],"mappings":"ubAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,SAAT,KAA0B,kBAA1B,CACA,OAASC,QAAT,KAAyB,WAAzB,CACA,MAAO,gBAAP,C,wFAEA,GAAMC,SAAQ,CAAG,QAAXA,SAAW,EAAM,CACrB,eAAeF,SAAS,EAAxB,CAAQG,EAAR,YAAQA,EAAR,CACA,cAAwBL,QAAQ,CAAC,IAAD,CAAhC,wCAAOM,IAAP,eAAaC,OAAb,eACA,eAA0CP,QAAQ,CAAC,EAAD,CAAlD,yCAAOQ,aAAP,eAAsBC,gBAAtB,eACA,eAA4CT,QAAQ,CAAC,EAAD,CAApD,yCAAOU,cAAP,eAAuBC,iBAAvB,eACA,eAAgCX,QAAQ,CAAC,EAAD,CAAxC,yCAAOY,QAAP,eAAiBC,WAAjB,eAEAZ,SAAS,CAAC,UAAM,CACd,GAAMa,UAAS,4FAAG,gNAEgBX,SAAQ,CACnCY,IAD2B,CACtB,OADsB,EAE3BC,MAF2B,CAEpB,GAFoB,EAG3BC,EAH2B,CAGxB,IAHwB,CAGlBZ,EAHkB,EAI3Ba,MAJ2B,EAFhB,4CAENC,IAFM,uBAENA,IAFM,CAEAC,KAFA,uBAEAA,KAFA,KAOVA,KAPU,8BAQNA,MARM,QAUdb,OAAO,CAACY,IAAD,CAAP,CAVc,iFAYdE,OAAO,CAACD,KAAR,CAAc,sBAAd,CAAsC,YAAME,OAA5C,EAZc,qEAAH,kBAATR,UAAS,0CAAf,CAgBA,GAAMS,cAAa,6FAAG,wNAEYpB,SAAQ,CACnCY,IAD2B,CACtB,UADsB,EAE3BC,MAF2B,CAEpB,GAFoB,EAG3BC,EAH2B,CAGxB,SAHwB,CAGbZ,EAHa,CAFZ,8CAEVc,IAFU,wBAEVA,IAFU,CAEJC,KAFI,wBAEJA,KAFI,KAMdA,KANc,+BAOVA,MAPU,QASlBP,WAAW,CAACM,IAAD,CAAX,CATkB,qFAWlBE,OAAO,CAACD,KAAR,CAAc,0BAAd,CAA0C,aAAME,OAAhD,EAXkB,uEAAH,kBAAbC,cAAa,2CAAnB,CAeAT,SAAS,GACTS,aAAa,GACd,CAlCQ,CAkCN,CAAClB,EAAD,CAlCM,CAAT,CAoCA,GAAMmB,oBAAmB,6FAAG,kBAAOC,KAAP,8JAC1BA,KAAK,CAACC,cAAN,GAD0B,wCAGMvB,SAAQ,CAACY,IAAT,CAAc,UAAd,EAA0BY,MAA1B,CAAiC,CAC7D,CACEC,OAAO,CAAEvB,EADX,CAEEwB,cAAc,CAAErB,aAFlB,CAGEsB,IAAI,CAAEpB,cAHR,CAD6D,CAAjC,CAHN,8CAGhBS,IAHgB,wBAGhBA,IAHgB,CAGVC,KAHU,wBAGVA,KAHU,KAUpBA,KAVoB,+BAWhBA,MAXgB,QAaxB;AACAW,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAdwB,qFAgBxBZ,OAAO,CAACD,KAAR,CAAc,uBAAd,CAAuC,aAAME,OAA7C,EAhBwB,uEAAH,kBAAnBE,oBAAmB,6CAAzB,CAoBA,GAAMU,oBAAmB,6FAAG,kBAAOC,SAAP,oLAElBhC,SAAQ,CAACY,IAAT,CAAc,UAAd,EAA0BqB,MAA1B,GAAmCnB,EAAnC,CAAsC,IAAtC,CAA4CkB,SAA5C,CAFkB,QAGxB;AACME,eAJkB,CAIAzB,QAAQ,CAAC0B,MAAT,CAAgB,SAACC,OAAD,QAAaA,QAAO,CAAClC,EAAR,GAAe8B,SAA5B,EAAhB,CAJA,CAKxBtB,WAAW,CAACwB,eAAD,CAAX,CALwB,mFAOxBhB,OAAO,CAACD,KAAR,CAAc,yBAAd,CAAyC,aAAME,OAA/C,EAPwB,sEAAH,kBAAnBY,oBAAmB,8CAAzB,CAWA,GAAI,CAAC5B,IAAL,CAAW,CACT,mBAAO,mCAAP,CACD,CAED,mBACE,aAAK,SAAS,CAAC,UAAf,wBACE,oBAAKA,IAAI,CAACkC,KAAV,EADF,cAEE,gCAAYlC,IAAI,CAACmC,MAAjB,GAFF,CAGGnC,IAAI,CAACoC,KAAL,eAAc,YAAK,GAAG,CAAEpC,IAAI,CAACoC,KAAf,CAAsB,GAAG,CAAC,MAA1B,EAHjB,cAIE,qCAAiBpC,IAAI,CAACqC,WAAtB,GAJF,cAKE,oCAAgB,GAAIC,KAAJ,CAAStC,IAAI,CAACuC,UAAd,EAA0BC,cAA1B,EAAhB,GALF,cAOE,oCACE,gCADF,cAEE,cAAM,QAAQ,CAAEtB,mBAAhB,wBACE,cACE,IAAI,CAAC,MADP,CAEE,WAAW,CAAC,WAFd,CAGE,KAAK,CAAEhB,aAHT,CAIE,QAAQ,CAAE,kBAACiB,KAAD,QAAWhB,iBAAgB,CAACgB,KAAK,CAACsB,MAAN,CAAaC,KAAd,CAA3B,EAJZ,CAKE,QAAQ,KALV,EADF,cAQE,iBACE,WAAW,CAAC,cADd,CAEE,KAAK,CAAEtC,cAFT,CAGE,QAAQ,CAAE,kBAACe,KAAD,QAAWd,kBAAiB,CAACc,KAAK,CAACsB,MAAN,CAAaC,KAAd,CAA5B,EAHZ,CAIE,QAAQ,KAJV,EARF,cAcE,eAAQ,IAAI,CAAC,QAAb,4BAdF,GAFF,cAkBE,qBACGpC,QAAQ,CAACqC,GAAT,CAAa,SAACV,OAAD,qBACZ,oCACE,mBAAIA,OAAO,CAACV,cAAZ,EADF,cAEE,mBAAIU,OAAO,CAACT,IAAZ,EAFF,cAGE,mBAAI,GAAIc,KAAJ,CAASL,OAAO,CAACM,UAAjB,EAA6BC,cAA7B,EAAJ,EAHF,cAIE,eAAQ,OAAO,CAAE,yBAAMZ,oBAAmB,CAACK,OAAO,CAAClC,EAAT,CAAzB,EAAjB,oBAJF,GAAUkC,OAAO,CAAClC,EAAlB,CADY,EAAb,CADH,EAlBF,GAPF,GADF,CAuCD,CArHD,CAuHA,cAAeD,SAAf"},"metadata":{},"sourceType":"module"}